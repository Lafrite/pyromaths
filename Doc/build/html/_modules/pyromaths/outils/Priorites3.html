

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>pyromaths.outils.Priorites3 &mdash; Pyromaths 13.03 documentation</title>
    
    <link rel="stylesheet" href="../../../_static/haiku.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/print.css" type="text/css" media="print" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '13.03',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../../_static/translations.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../../../_static/theme_extras.js"></script>
    <link rel="top" title="Pyromaths 13.03 documentation" href="../../../index.html" />
    <link rel="up" title="Code du module" href="../../index.html" /> 
  </head>
  <body>
      <div class="header"><img class="rightlogo" src="../../../_static/bandeau.png" alt="Logo"/><h1 class="heading"><a href="../../../index.html">
          <span>Pyromaths 13.03 documentation</span></a></h1>
        <h2 class="heading"><span>pyromaths.outils.Priorites3</span></h2>
      </div>
      <div class="topnav">
      
        <p>
        <a class="uplink" href="../../../index.html">Contenu</a>
        </p>

      </div>
      <div class="content">
        
        
  <h1>Code source de pyromaths.outils.Priorites3</h1><div class="highlight"><pre>
<span class="c">#!/usr/bin/python</span>
<span class="c"># -*- coding: utf-8 -*-</span>
<span class="c">#</span>
<span class="c"># Pyromaths</span>
<span class="c"># Un programme en Python qui permet de créer des fiches d&#39;exercices types de</span>
<span class="c"># mathématiques niveau collège ainsi que leur corrigé en LaTeX.</span>
<span class="c"># Copyright (C) 2006 -- Jérôme Ortais (jerome.ortais@pyromaths.org)</span>
<span class="c">#</span>
<span class="c"># This program is free software; you can redistribute it and/or modify</span>
<span class="c"># it under the terms of the GNU General Public License as published by</span>
<span class="c"># the Free Software Foundation; either version 2 of the License, or</span>
<span class="c"># (at your option) any later version.</span>
<span class="c">#</span>
<span class="c"># This program is distributed in the hope that it will be useful,</span>
<span class="c"># but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="c"># MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the</span>
<span class="c"># GNU General Public License for more details.</span>
<span class="c">#</span>
<span class="c"># You should have received a copy of the GNU General Public License</span>
<span class="c"># along with this program; if not, write to the Free Software</span>
<span class="c"># Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA</span>
<span class="c">#</span>
<span class="c">#----------------------------------------------------------------------</span>
<span class="c"># Pyromaths : GESTION DES PRIORITES</span>
<span class="c">#----------------------------------------------------------------------</span>
<span class="kn">from</span> <span class="nn">..classes.PolynomesCollege</span> <span class="kn">import</span> <span class="n">Polynome</span>
<span class="kn">from</span> <span class="nn">..outils.Affichage</span> <span class="kn">import</span> <span class="n">decimaux</span>


<div class="viewcode-block" id="cherche_polynome"><a class="viewcode-back" href="../../../pyromaths.outils.Priorites3.html#pyromaths.outils.Priorites3.cherche_polynome">[docs]</a><span class="k">def</span> <span class="nf">cherche_polynome</span><span class="p">(</span><span class="n">calcul</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;**cherche_polynome**\ (*calcul*\ , *index*)</span>

<span class="sd">    Recherche le premier polynôme dans la chaîne calcul à une position</span>
<span class="sd">    supérieure ou égale à index, sans expression régulière</span>

<span class="sd">    :param calcul: le calcul à tester</span>
<span class="sd">    :type calcul: string</span>
<span class="sd">    :param index: position à partir de laquelle effectuer le test</span>
<span class="sd">    :type index: integer</span>
<span class="sd">    </span>
<span class="sd">    &gt;&gt;&gt; from pyromaths.outils import Priorites3</span>
<span class="sd">    &gt;&gt;&gt; p = &#39;Polynome([[-4, 2]], &quot;x&quot;)-Polynome([[-5, 1], [4, 2], [1, 0]], &quot;x&quot;)+Polynome([[6,  0], [5, 1]], &quot;x&quot;)&#39;</span>
<span class="sd">    &gt;&gt;&gt; Priorites3.cherche_polynome(p, 5)</span>
<span class="sd">    &#39;Polynome([[-5, 1], [4, 2], [1, 0]], &quot;x&quot;)&#39; </span>

<span class="sd">    :rtype: string</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">index</span> <span class="o">=</span> <span class="n">calcul</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s">&quot;Polynome(&quot;</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">index</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span> <span class="k">return</span> <span class="bp">None</span>
    <span class="n">par</span><span class="p">,</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">index</span><span class="o">+</span><span class="mi">9</span> <span class="c"># nombre de parenthèses ouvertes, début de recherche</span>
    <span class="k">while</span> <span class="n">par</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">calcul</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s">&quot;(&quot;</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">i</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">calcul</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s">&quot;(&quot;</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="n">calcul</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s">&quot;)&quot;</span><span class="p">,</span> <span class="n">i</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">i</span> <span class="o">=</span> <span class="n">calcul</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s">&quot;)&quot;</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">calcul</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="s">&quot;)&quot;</span><span class="p">:</span> <span class="n">par</span> <span class="o">+=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span> <span class="n">par</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">calcul</span><span class="p">[</span><span class="n">index</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
</div>
<div class="viewcode-block" id="cherche_decimal"><a class="viewcode-back" href="../../../pyromaths.outils.Priorites3.html#pyromaths.outils.Priorites3.cherche_decimal">[docs]</a><span class="k">def</span> <span class="nf">cherche_decimal</span><span class="p">(</span><span class="n">calcul</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;**cherche_decimal**\ (*calcul*\ , *index*)</span>

<span class="sd">    Recherche le premier nombre décimal dans la chaîne calcul à une position</span>
<span class="sd">    supérieure ou égale à index, sans expression régulière.</span>
<span class="sd">    Un nombre décimal peut être entouré de parenthèses s&#39;il a un signe, ou avoir</span>
<span class="sd">    un signe s&#39;il est en début de chaîne.</span>
<span class="sd">    </span>
<span class="sd">    Cette fonction est 130 fois plus rapide qu&#39;avec une expression régulière.</span>

<span class="sd">    :param calcul: le calcul à tester</span>
<span class="sd">    :type calcul: string</span>
<span class="sd">    :param index: position à partir de laquelle effectuer le test</span>
<span class="sd">    :type index: integer</span>
<span class="sd">    </span>
<span class="sd">    &gt;&gt;&gt; from pyromaths.outils import Priorites3</span>
<span class="sd">    &gt;&gt;&gt; p = &#39;-Polynome([[-4, 2]], &quot;x&quot;)*6**2+3&#39;</span>
<span class="sd">    &gt;&gt;&gt; Priorites3.cherche_decimal(p, 1)</span>
<span class="sd">    &#39;4&#39;</span>
<span class="sd">    &gt;&gt;&gt; p = &#39;-6*(-11)*(-5)&#39;</span>
<span class="sd">    &gt;&gt;&gt; Priorites3.cherche_decimal(p, 1)</span>
<span class="sd">    &#39;6&#39;</span>
<span class="sd">    &gt;&gt;&gt; Priorites3.cherche_decimal(p, 0)</span>
<span class="sd">    &#39;6&#39;</span>

<span class="sd">    **TODO :** vérifier ces deux derniers exemples. Je pense que je devrais récupérer -6</span>
<span class="sd">    </span>
<span class="sd">    :rtype: string</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">end</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">calcul</span><span class="p">)</span>
    <span class="k">while</span> <span class="n">index</span><span class="o">&lt;=</span><span class="n">end</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="nb">int</span><span class="p">(</span><span class="n">calcul</span><span class="p">[</span><span class="n">index</span><span class="p">])</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">index</span><span class="o">+=</span><span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">break</span>
    <span class="k">if</span> <span class="n">index</span><span class="o">&gt;</span><span class="n">end</span><span class="p">:</span> <span class="k">return</span> <span class="bp">None</span>
    <span class="k">while</span> <span class="n">end</span><span class="o">&gt;</span><span class="n">index</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="nb">float</span><span class="p">(</span><span class="n">calcul</span><span class="p">[</span><span class="n">index</span><span class="p">:</span><span class="n">end</span><span class="p">])</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="n">end</span> <span class="o">-=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">break</span>
    <span class="k">if</span> <span class="n">index</span><span class="o">&gt;</span><span class="mi">1</span> <span class="ow">and</span> <span class="p">(</span><span class="n">calcul</span><span class="p">[</span><span class="n">index</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">index</span><span class="p">]</span> <span class="o">==</span> <span class="s">&quot;(+&quot;</span> <span class="ow">or</span> <span class="n">calcul</span><span class="p">[</span><span class="n">index</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">index</span><span class="p">]</span> <span class="o">==</span>
            <span class="s">&quot;(-&quot;</span><span class="p">)</span> <span class="p">:</span>
        <span class="k">if</span> <span class="n">end</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">calcul</span><span class="p">)</span> <span class="ow">and</span> <span class="n">calcul</span><span class="p">[</span><span class="n">end</span><span class="p">]</span><span class="o">==</span><span class="s">&quot;)&quot;</span><span class="p">:</span>
            <span class="n">index</span> <span class="o">-=</span> <span class="mi">2</span>
            <span class="n">end</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">index</span> <span class="o">-=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">calcul</span><span class="p">[</span><span class="n">index</span><span class="p">:</span><span class="n">end</span><span class="p">]</span>
</div>
<div class="viewcode-block" id="split_calcul"><a class="viewcode-back" href="../../../pyromaths.outils.Priorites3.html#pyromaths.outils.Priorites3.split_calcul">[docs]</a><span class="k">def</span> <span class="nf">split_calcul</span><span class="p">(</span><span class="n">calcul</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;**split_calcul**\ (*calcul*)</span>

<span class="sd">    Partitionne la chaîne de caractères pour obtenir une liste d&#39;opérateurs,</span>
<span class="sd">    de parenthèses, de polynômes et de nombres</span>

<span class="sd">    :param calcul: le calcul à traiter</span>
<span class="sd">    :type calcul: string</span>
<span class="sd">    </span>
<span class="sd">    &gt;&gt;&gt; from pyromaths.outils import Priorites3</span>
<span class="sd">    &gt;&gt;&gt; p = &#39;-Polynome([[-4, 2]], &quot;x&quot;)*6**2+3&#39;</span>
<span class="sd">    &gt;&gt;&gt; Priorites3.split_calcul(p)</span>
<span class="sd">    [&#39;-&#39;, &#39;Polynome([[-4, 2]], &quot;x&quot;)&#39;, &#39;*&#39;, &#39;6&#39;, &#39;**&#39;, &#39;2&#39;, &#39;+&#39;, &#39;3&#39;]</span>
<span class="sd">    &gt;&gt;&gt; p = &#39;-6*(-11)*(-5)&#39;</span>
<span class="sd">    &gt;&gt;&gt; Priorites3.split_calcul(p)</span>
<span class="sd">    [&#39;-&#39;, &#39;6&#39;, &#39;*&#39;, &#39;(-11)&#39;, &#39;*&#39;, &#39;(-5)&#39;]</span>

<span class="sd">    **TODO :** vérifier ce dernier exemple. Je pense que je devrais récupérer -6</span>
<span class="sd">    </span>
<span class="sd">    :rtype: list</span>
<span class="sd">    &quot;&quot;&quot;</span> 
    <span class="n">l</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">findings</span> <span class="o">=</span> <span class="p">(</span><span class="n">cherche_polynome</span><span class="p">,</span> <span class="n">cherche_decimal</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">finding</span> <span class="ow">in</span> <span class="n">findings</span><span class="p">:</span>
        <span class="n">nb</span> <span class="o">=</span> <span class="n">finding</span><span class="p">(</span><span class="n">calcul</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="k">while</span> <span class="n">nb</span><span class="p">:</span>
            <span class="n">l</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">calcul</span><span class="o">.</span><span class="n">partition</span><span class="p">(</span><span class="n">nb</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">l</span><span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">]</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]:</span>
                <span class="n">l0</span> <span class="o">=</span> <span class="n">split_calcul</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">])</span>
                <span class="k">if</span> <span class="n">l0</span><span class="p">:</span>
                    <span class="n">l0</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">:])</span>
                    <span class="n">l</span> <span class="o">=</span> <span class="n">l</span><span class="p">[:</span><span class="o">-</span><span class="mi">3</span><span class="p">]</span>
                    <span class="n">l</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">l0</span><span class="p">)</span>
            <span class="k">elif</span> <span class="ow">not</span> <span class="n">l</span><span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">]:</span>
                <span class="n">l</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span>
            <span class="n">calcul</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">nb</span> <span class="o">=</span> <span class="n">finding</span><span class="p">(</span><span class="n">calcul</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
            <span class="n">l</span> <span class="o">=</span> <span class="n">l</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">calcul</span><span class="p">:</span> <span class="n">l</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">calcul</span><span class="p">)</span>
    <span class="k">while</span> <span class="n">l</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">l</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
        <span class="n">l</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">l</span>
</div>
<div class="viewcode-block" id="EstNombre"><a class="viewcode-back" href="../../../pyromaths.outils.Priorites3.html#pyromaths.outils.Priorites3.EstNombre">[docs]</a><span class="k">def</span> <span class="nf">EstNombre</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;**EstNombre**\ (*value*)</span>

<span class="sd">    Teste si `value` est une valeur, c&#39;est à dire un entier, un réel, un polynôme</span>

<span class="sd">    :param value: la valeur à traiter</span>
<span class="sd">    :type value: string</span>
<span class="sd">    </span>
<span class="sd">    &gt;&gt;&gt; from pyromaths.outils import Priorites3</span>
<span class="sd">    &gt;&gt;&gt; v = &#39;-15&#39;</span>
<span class="sd">    &gt;&gt;&gt; Priorites3.EstNombre(v)</span>
<span class="sd">    True</span>
<span class="sd">    &gt;&gt;&gt; v = &#39;Polynome([[-4, 2]], &quot;x&quot;)&#39;</span>
<span class="sd">    &gt;&gt;&gt; Priorites3.EstNombre(v)</span>
<span class="sd">    True</span>

<span class="sd">    :rtype: list</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">value</span> <span class="ow">in</span> <span class="s">&quot;**/+-()&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">False</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">isinstance</span><span class="p">(</span><span class="nb">eval</span><span class="p">(</span><span class="n">value</span><span class="p">),</span> <span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="n">Polynome</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="splitting"><a class="viewcode-back" href="../../../pyromaths.outils.Priorites3.html#pyromaths.outils.Priorites3.splitting">[docs]</a><span class="k">def</span> <span class="nf">splitting</span><span class="p">(</span><span class="n">calcul</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;**split_calcul**\ (*calcul*)</span>

<span class="sd">    Partitionne la chaîne de caractères pour obtenir une liste d&#39;opérateurs,</span>
<span class="sd">    de parenthèses, de polynômes et de nombres puis arrange la liste des</span>
<span class="sd">    opérandes et opérateurs</span>

<span class="sd">    :param calcul: le calcul à traiter</span>
<span class="sd">    :type calcul: string</span>
<span class="sd">    </span>
<span class="sd">    &gt;&gt;&gt; from pyromaths.outils import Priorites3</span>
<span class="sd">    &gt;&gt;&gt; p = &#39;-Polynome([[-4, 2]], &quot;x&quot;)*6**2+3&#39;</span>
<span class="sd">    &gt;&gt;&gt; Priorites3.splitting(p)</span>
<span class="sd">    [&#39;-&#39;, &#39;Polynome([[-4, 2]], &quot;x&quot;)&#39;, &#39;*&#39;, &#39;6&#39;, &#39;**&#39;, &#39;2&#39;, &#39;+&#39;, &#39;3&#39;]</span>
<span class="sd">    &gt;&gt;&gt; p = &#39;-6*(-11)*(-5)&#39;</span>
<span class="sd">    &gt;&gt;&gt; Priorites3.split_calcul(p)</span>
<span class="sd">    [&#39;-6&#39;, &#39;*&#39;, &#39;(-11)&#39;, &#39;*&#39;, &#39;(-5)&#39;]</span>

<span class="sd">    **TODO :** Ce dernier exemple fonctionne ici. Quelle différence avec split_calcul ?</span>
<span class="sd">    </span>
<span class="sd">    :rtype: list</span>
<span class="sd">    &quot;&quot;&quot;</span> 
    <span class="k">if</span> <span class="n">calcul</span> <span class="o">==</span> <span class="s">&quot;&quot;</span><span class="p">:</span> <span class="k">return</span> <span class="p">[]</span>
    <span class="n">l</span> <span class="o">=</span> <span class="n">split_calcul</span><span class="p">(</span><span class="n">calcul</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">l</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s">&quot;+&quot;</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span> <span class="n">l</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+=</span> <span class="n">l</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">l</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s">&quot;-&quot;</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">l</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="s">&quot;0123456789&quot;</span><span class="p">:</span> <span class="n">l</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+=</span> <span class="n">l</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">while</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">):</span>
        <span class="n">op</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">t</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="mi">0</span><span class="p">,</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">op</span> <span class="o">==</span> <span class="s">&quot;**&quot;</span><span class="p">:</span> <span class="n">j</span><span class="o">+=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">op</span><span class="p">)</span> <span class="ow">and</span> <span class="n">op</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">in</span> <span class="s">&#39;+-*/()&#39;</span><span class="p">:</span>
                <span class="n">t</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">op</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">op</span><span class="p">):</span>
                <span class="n">l</span><span class="p">[</span><span class="n">j</span><span class="p">:</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">t</span>
                <span class="n">j</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span> <span class="n">j</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">l</span>
</div>
<div class="viewcode-block" id="recherche_parentheses"><a class="viewcode-back" href="../../../pyromaths.outils.Priorites3.html#pyromaths.outils.Priorites3.recherche_parentheses">[docs]</a><span class="k">def</span> <span class="nf">recherche_parentheses</span><span class="p">(</span><span class="n">calcul</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;**recherche_parentheses**\ (*calcul*)</span>

<span class="sd">    Recherche les premières parenthèses (éventuellement intérieures) dans une expression</span>

<span class="sd">    :param calcul: le calcul à traiter</span>
<span class="sd">    :type calcul: list</span>
<span class="sd">    </span>
<span class="sd">    &gt;&gt;&gt; from pyromaths.outils import Priorites3</span>
<span class="sd">    &gt;&gt;&gt; c = [&#39;-6&#39;, &#39;*&#39;, &#39;(-11)&#39;, &#39;*&#39;, &#39;(-5)&#39;]</span>
<span class="sd">    &gt;&gt;&gt; Priorites3.recherche_parentheses(c)</span>
<span class="sd">    &gt;&gt;&gt;</span>
<span class="sd">    &gt;&gt;&gt; c = [&#39;-9&#39;, &#39;-&#39;, &#39;6&#39;, &#39;*&#39;, &#39;(&#39;, &#39;(-2)&#39;, &#39;-&#39;, &#39;4&#39;, &#39;)&#39;]</span>
<span class="sd">    &gt;&gt;&gt; Priorites3.recherche_parentheses(c)</span>
<span class="sd">    (4, 9)</span>

<span class="sd">    :rtype: tuple</span>
<span class="sd">    &quot;&quot;&quot;</span>     
    <span class="k">if</span> <span class="n">calcul</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s">&quot;(&quot;</span><span class="p">):</span>
        <span class="n">debut</span> <span class="o">=</span> <span class="n">calcul</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s">&quot;(&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">calcul</span><span class="p">[</span><span class="n">debut</span><span class="o">+</span><span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s">&quot;)&quot;</span><span class="p">):</span> <span class="n">fin</span> <span class="o">=</span> <span class="n">calcul</span><span class="p">[</span><span class="n">debut</span><span class="p">:]</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s">&quot;)&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">debut</span>
        <span class="k">else</span><span class="p">:</span> <span class="k">return</span> <span class="bp">None</span>
        <span class="k">for</span> <span class="n">dummy</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">calcul</span><span class="p">[</span><span class="n">debut</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:</span><span class="n">fin</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s">&quot;(&quot;</span><span class="p">)):</span>
            <span class="n">debut</span> <span class="o">+=</span> <span class="n">calcul</span><span class="p">[</span><span class="n">debut</span><span class="o">+</span><span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s">&quot;(&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">debut</span><span class="p">,</span> <span class="n">fin</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">None</span>
</div>
<div class="viewcode-block" id="recherche_puissance"><a class="viewcode-back" href="../../../pyromaths.outils.Priorites3.html#pyromaths.outils.Priorites3.recherche_puissance">[docs]</a><span class="k">def</span> <span class="nf">recherche_puissance</span><span class="p">(</span><span class="n">calcul</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;**recherche_puissance**\ (*calcul*)</span>

<span class="sd">    Recherche la première occurrence d&#39;une puissance dans une liste de</span>
<span class="sd">    calculs. Elle doit être entourée de deux nombres.</span>

<span class="sd">    :param calcul: le calcul à traiter</span>
<span class="sd">    :type calcul: list</span>
<span class="sd">    </span>
<span class="sd">    &gt;&gt;&gt; from pyromaths.outils import Priorites3</span>
<span class="sd">    &gt;&gt;&gt; c = [&#39;-6&#39;, &#39;**&#39;, &#39;(-11)&#39;, &#39;*&#39;, &#39;(-5)&#39;]</span>
<span class="sd">    &gt;&gt;&gt; Priorites3.recherche_puissance(c)</span>
<span class="sd">    (0, 3) </span>
<span class="sd">    &gt;&gt;&gt; p = [&#39;-&#39;, &#39;Polynome([[-4, 2]], &quot;x&quot;)&#39;, &#39;**&#39;, &#39;2&#39;, &#39;+&#39;, &#39;3&#39;]</span>
<span class="sd">    &gt;&gt;&gt; Priorites3.recherche_puissance(p)</span>
<span class="sd">    (1, 4)</span>

<span class="sd">    :rtype: tuple</span>
<span class="sd">    &quot;&quot;&quot;</span>     
    <span class="k">if</span> <span class="n">calcul</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s">&quot;**&quot;</span><span class="p">):</span>
        <span class="n">i</span> <span class="o">=</span> <span class="n">calcul</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s">&quot;**&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">None</span>
</div>
<div class="viewcode-block" id="recherche_operation"><a class="viewcode-back" href="../../../pyromaths.outils.Priorites3.html#pyromaths.outils.Priorites3.recherche_operation">[docs]</a><span class="k">def</span> <span class="nf">recherche_operation</span><span class="p">(</span><span class="n">calcul</span><span class="p">,</span> <span class="n">op</span><span class="p">,</span> <span class="n">l_interdit</span><span class="p">,</span> <span class="n">debut</span> <span class="o">=</span> <span class="mi">0</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;**recherche_operation**\ (*calcul*\ , *op*\ , *l_interdit*\ [, *debut*])</span>

<span class="sd">    Recherche la première occurrence de l&#39;opération op dans la liste de</span>
<span class="sd">    calculs list. L&#39;opérateur doit être entouré de deux nombres, le premier ne</span>
<span class="sd">    doit pas être précédé d&#39;un opérateur inclus dans la liste l_interdit.</span>
<span class="sd">    L&#39;opérateur à trouver doit être avant la position debut (si debut est non</span>
<span class="sd">    nul).</span>

<span class="sd">    :param calcul: le calcul à traiter</span>
<span class="sd">    :type calcul: list</span>
<span class="sd">    :param op: l&#39;opérateur à chercher</span>
<span class="sd">    :type op: string</span>
<span class="sd">    :param l_interdit: liste des opérateurs à ignorer, pour respecter les priorités</span>
<span class="sd">    :type l_interdit: list</span>
<span class="sd">    :param debut: À partir d&#39;où chercher l&#39;opérateur dans l&#39;expression</span>
<span class="sd">    :type debut: integer</span>
<span class="sd">    </span>
<span class="sd">    &gt;&gt;&gt; from pyromaths.outils import Priorites3</span>
<span class="sd">    &gt;&gt;&gt; c = [&#39;-6&#39;, &#39;**&#39;, &#39;(-11)&#39;, &#39;*&#39;, &#39;(-5)&#39;]</span>
<span class="sd">    &gt;&gt;&gt; Priorites3.recherche_operation(c, &quot;*&quot;, (&quot;**&quot;, &quot;/&quot;))</span>
<span class="sd">    &gt;&gt;&gt; </span>
<span class="sd">    &gt;&gt;&gt; c = [&#39;-9&#39;, &#39;-&#39;, &#39;6&#39;, &#39;*&#39;, &#39;2&#39;, &#39;-&#39;, &#39;4&#39;]</span>
<span class="sd">    &gt;&gt;&gt; Priorites3.recherche_operation(c, &quot;*&quot;, (&quot;**&quot;, &quot;/&quot;))</span>
<span class="sd">    3</span>

<span class="sd">    :rtype: integer</span>
<span class="sd">    &quot;&quot;&quot;</span>     
    <span class="n">ind</span><span class="p">,</span> <span class="n">fin</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">calcul</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">dummy</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">calcul</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">op</span><span class="p">)):</span>
        <span class="n">ind</span> <span class="o">=</span> <span class="n">calcul</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">op</span><span class="p">,</span> <span class="n">ind</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">ind</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">ind</span> <span class="o">&lt;</span> <span class="n">fin</span><span class="o">-</span><span class="mi">1</span> <span class="ow">and</span> <span class="n">EstNombre</span><span class="p">(</span><span class="n">calcul</span><span class="p">[</span><span class="n">ind</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="ow">and</span>\
            <span class="n">EstNombre</span><span class="p">(</span><span class="n">calcul</span><span class="p">[</span><span class="n">ind</span><span class="o">+</span><span class="mi">1</span><span class="p">]):</span>
                <span class="k">if</span> <span class="n">debut</span><span class="p">:</span> <span class="n">debut</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">debut</span><span class="p">,</span> <span class="n">ind</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span> <span class="n">debut</span> <span class="o">=</span> <span class="n">ind</span>
                <span class="k">break</span>
        <span class="k">elif</span> <span class="n">ind</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">ind</span> <span class="o">&lt;</span> <span class="n">fin</span> <span class="o">-</span><span class="mi">1</span> <span class="ow">and</span> <span class="n">EstNombre</span><span class="p">(</span><span class="n">calcul</span><span class="p">[</span><span class="n">ind</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="ow">and</span>\
            <span class="n">EstNombre</span><span class="p">(</span><span class="n">calcul</span><span class="p">[</span><span class="n">ind</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="ow">and</span> <span class="n">calcul</span><span class="p">[</span><span class="n">ind</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">l_interdit</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">debut</span><span class="p">:</span> <span class="n">debut</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">debut</span><span class="p">,</span> <span class="n">ind</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span> <span class="n">debut</span> <span class="o">=</span> <span class="n">ind</span>
                <span class="k">break</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ind</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="n">debut</span><span class="p">:</span> <span class="k">return</span> <span class="n">debut</span>
    <span class="k">else</span><span class="p">:</span> <span class="k">return</span> <span class="bp">None</span>
</div>
<div class="viewcode-block" id="recherche_fin_operation"><a class="viewcode-back" href="../../../pyromaths.outils.Priorites3.html#pyromaths.outils.Priorites3.recherche_fin_operation">[docs]</a><span class="k">def</span> <span class="nf">recherche_fin_operation</span><span class="p">(</span><span class="n">calcul</span><span class="p">,</span> <span class="n">op</span><span class="p">,</span> <span class="n">l_interdit</span><span class="p">,</span> <span class="n">debut</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;**recherche_fin_operation**\ (*calcul*\ , *op*\ , *l_interdit*\ , *debut*)</span>

<span class="sd">    Recherche la fin de la suite d&#39;opération @op situé à la position @debut</span>
<span class="sd">    de la liste de calculs @calcul, en vérifiant que cet enchaînement n&#39;est pas</span>
<span class="sd">    suivi par un opérateur compris dans @l_interdit.</span>

<span class="sd">    :param calcul: le calcul à traiter</span>
<span class="sd">    :type calcul: string</span>
<span class="sd">    :param op: l&#39;opérateur à chercher</span>
<span class="sd">    :type op: string</span>
<span class="sd">    :param l_interdit: liste des opérateurs à ignorer, pour respecter les priorités</span>
<span class="sd">    :type l_interdit: list</span>
<span class="sd">    :param debut: À partir d&#39;où chercher l&#39;opérateur dans l&#39;expression</span>
<span class="sd">    :type debut: integer</span>
<span class="sd">    </span>
<span class="sd">    &gt;&gt;&gt; from pyromaths.outils import Priorites3</span>
<span class="sd">    &gt;&gt;&gt; c     = [&#39;-9&#39;, &#39;-&#39;, &#39;6&#39;, &#39;*&#39;, &#39;2&#39;, &#39;*&#39;, &#39;5&#39;, &#39;-&#39;, &#39;4&#39;]</span>
<span class="sd">    &gt;&gt;&gt; Priorites3.recherche_fin_operation(c, &quot;*&quot;, (&quot;**&quot;, &quot;/&quot;),0)</span>
<span class="sd">    2</span>
<span class="sd">    &gt;&gt;&gt; Priorites3.recherche_fin_operation(c, &quot;*&quot;, (&quot;**&quot;, &quot;/&quot;),4)</span>
<span class="sd">    6</span>

<span class="sd">    :rtype: integer</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">index</span><span class="p">,</span> <span class="n">fin</span> <span class="o">=</span> <span class="n">debut</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">calcul</span><span class="p">)</span>
    <span class="k">while</span> <span class="n">index</span> <span class="o">&lt;</span> <span class="n">fin</span><span class="o">-</span><span class="mi">1</span> <span class="ow">and</span> <span class="n">calcul</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">==</span> <span class="n">op</span> <span class="ow">and</span> <span class="n">EstNombre</span><span class="p">(</span><span class="n">calcul</span><span class="p">[</span><span class="n">index</span><span class="o">+</span><span class="mi">1</span><span class="p">]):</span>
        <span class="n">index</span> <span class="o">+=</span><span class="mi">2</span>
    <span class="k">if</span> <span class="n">index</span> <span class="o">&lt;</span> <span class="n">fin</span> <span class="ow">and</span> <span class="n">calcul</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="ow">in</span> <span class="n">l_interdit</span><span class="p">:</span>
        <span class="n">index</span> <span class="o">-=</span><span class="mi">2</span>
    <span class="k">if</span> <span class="n">index</span> <span class="o">==</span> <span class="n">debut</span><span class="p">:</span> <span class="k">return</span> <span class="bp">None</span>
    <span class="k">return</span> <span class="n">index</span>
</div>
<div class="viewcode-block" id="recherche_produit"><a class="viewcode-back" href="../../../pyromaths.outils.Priorites3.html#pyromaths.outils.Priorites3.recherche_produit">[docs]</a><span class="k">def</span> <span class="nf">recherche_produit</span><span class="p">(</span><span class="n">calcul</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;**recherche_produit**\ (*calcul*)</span>

<span class="sd">    Recherche la première occurrence d&#39;une multiplication ou divisions dans</span>
<span class="sd">    une liste de calculs. Elle doit être précédée d&#39;un nombre qui ne doit pas</span>
<span class="sd">    être précédé d&#39;une puissance ou d&#39;une division, ni suivie d&#39;un exposant.</span>

<span class="sd">    :param calcul: le calcul à traiter</span>
<span class="sd">    :type calcul: list</span>
<span class="sd">        </span>
<span class="sd">    &gt;&gt;&gt; from pyromaths.outils import Priorites3</span>
<span class="sd">    &gt;&gt;&gt; c = [&#39;-9&#39;, &#39;-&#39;, &#39;6&#39;, &#39;*&#39;, &#39;2&#39;, &#39;*&#39;, &#39;5&#39;, &#39;-&#39;, &#39;4&#39;]</span>
<span class="sd">    &gt;&gt;&gt; Priorites3.recherche_produit(c)</span>
<span class="sd">    (2, 7)</span>

<span class="sd">    :rtype: tuple</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">debut</span> <span class="o">=</span> <span class="n">recherche_operation</span><span class="p">(</span><span class="n">calcul</span><span class="p">,</span> <span class="s">&quot;*&quot;</span><span class="p">,</span> <span class="p">(</span><span class="s">&quot;**&quot;</span><span class="p">,</span> <span class="s">&quot;/&quot;</span><span class="p">))</span>
    <span class="n">debut</span> <span class="o">=</span> <span class="n">recherche_operation</span><span class="p">(</span><span class="n">calcul</span><span class="p">,</span> <span class="s">&quot;/&quot;</span><span class="p">,</span> <span class="p">(</span><span class="s">&quot;**&quot;</span><span class="p">,</span> <span class="s">&quot;/&quot;</span><span class="p">),</span> <span class="n">debut</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">debut</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">fin</span> <span class="o">=</span> <span class="n">recherche_fin_operation</span><span class="p">(</span><span class="n">calcul</span><span class="p">,</span> <span class="n">calcul</span><span class="p">[</span><span class="n">debut</span><span class="p">],</span> <span class="p">(</span><span class="s">&quot;**&quot;</span><span class="p">),</span> <span class="n">debut</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">fin</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span> <span class="k">return</span> <span class="p">(</span><span class="n">debut</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">fin</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">None</span>
</div>
<div class="viewcode-block" id="recherche_somme"><a class="viewcode-back" href="../../../pyromaths.outils.Priorites3.html#pyromaths.outils.Priorites3.recherche_somme">[docs]</a><span class="k">def</span> <span class="nf">recherche_somme</span><span class="p">(</span><span class="n">calcul</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;**recherche_somme**\ (*calcul*)</span>

<span class="sd">    Recherche la première occurrence d&#39;une addition ou soustraction dans une</span>
<span class="sd">    liste de calculs. Elle doit être précédée d&#39;un nombre qui ne doit pas être</span>
<span class="sd">    précédé d&#39;une puissance, d&#39;une multiplication, d&#39;une division ou d&#39;une</span>
<span class="sd">    soustraction, ni suivie d&#39;un exposant, d&#39;une multiplaication ou d&#39;une</span>
<span class="sd">    division.</span>

<span class="sd">    :param calcul: le calcul à traiter</span>
<span class="sd">    :type calcul: list</span>
<span class="sd">    :rtype: tuple</span>
<span class="sd">    &quot;&quot;&quot;</span>    
    <span class="n">debut</span> <span class="o">=</span> <span class="n">recherche_operation</span><span class="p">(</span><span class="n">calcul</span><span class="p">,</span> <span class="s">&quot;+&quot;</span><span class="p">,</span> <span class="p">(</span><span class="s">&quot;**&quot;</span><span class="p">,</span> <span class="s">&quot;*&quot;</span><span class="p">,</span> <span class="s">&quot;/&quot;</span><span class="p">,</span> <span class="s">&quot;-&quot;</span><span class="p">))</span>
    <span class="n">debut</span> <span class="o">=</span> <span class="n">recherche_operation</span><span class="p">(</span><span class="n">calcul</span><span class="p">,</span> <span class="s">&quot;-&quot;</span><span class="p">,</span> <span class="p">(</span><span class="s">&quot;**&quot;</span><span class="p">,</span> <span class="s">&quot;*&quot;</span><span class="p">,</span> <span class="s">&quot;/&quot;</span><span class="p">,</span> <span class="s">&quot;-&quot;</span><span class="p">),</span> <span class="n">debut</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">debut</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">fin</span> <span class="o">=</span> <span class="n">recherche_fin_operation</span><span class="p">(</span><span class="n">calcul</span><span class="p">,</span> <span class="n">calcul</span><span class="p">[</span><span class="n">debut</span><span class="p">],</span> <span class="p">(</span><span class="s">&quot;**&quot;</span><span class="p">,</span> <span class="s">&quot;*&quot;</span><span class="p">,</span> <span class="s">&quot;/&quot;</span><span class="p">),</span>
                <span class="n">debut</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">fin</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span> <span class="k">return</span> <span class="p">(</span><span class="n">debut</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">fin</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">None</span>
</div>
<div class="viewcode-block" id="recherche_neg"><a class="viewcode-back" href="../../../pyromaths.outils.Priorites3.html#pyromaths.outils.Priorites3.recherche_neg">[docs]</a><span class="k">def</span> <span class="nf">recherche_neg</span><span class="p">(</span><span class="n">calcul</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;**recherche_neg**\ (*calcul*)</span>

<span class="sd">    Recherche la première occurence d&#39;un opposé `-(-5)` ou `-Polynome` ou</span>
<span class="sd">    d&#39;une écriture du style `+(-5)` dans une liste de calculs qui ne doit pas être</span>
<span class="sd">    suivie d&#39;un exposant.</span>

<span class="sd">    :param calcul: le calcul à traiter</span>
<span class="sd">    :type calcul: list</span>
<span class="sd">    :rtype: tuple</span>
<span class="sd">    &quot;&quot;&quot;</span>    
    <span class="n">ind</span><span class="p">,</span> <span class="n">debut</span><span class="p">,</span> <span class="n">fin</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">calcul</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">dummy</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">calcul</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s">&quot;-&quot;</span><span class="p">)):</span>
        <span class="n">ind</span> <span class="o">=</span> <span class="n">calcul</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s">&quot;-&quot;</span><span class="p">,</span> <span class="n">ind</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">ind</span> <span class="o">&lt;</span> <span class="n">fin</span><span class="o">-</span><span class="mi">1</span> <span class="ow">and</span> <span class="n">EstNombre</span><span class="p">(</span><span class="n">calcul</span><span class="p">[</span><span class="n">ind</span><span class="o">+</span><span class="mi">1</span><span class="p">]):</span>
            <span class="n">n</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">calcul</span><span class="p">[</span><span class="n">ind</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">calcul</span><span class="p">[</span><span class="n">ind</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s">&quot;(&quot;</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">Polynome</span><span class="p">):</span>
<span class="c">#                or (isinstance(n, Polynome) and (len(n)&gt;1 or n.monomes[0][0]&lt;0)):</span>
                <span class="n">debut</span> <span class="o">=</span> <span class="n">ind</span>
                <span class="k">break</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ind</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">for</span> <span class="n">dummy</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">calcul</span><span class="p">[</span><span class="n">ind</span><span class="o">+</span><span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s">&quot;+&quot;</span><span class="p">)):</span>
        <span class="n">ind</span> <span class="o">=</span> <span class="n">calcul</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s">&quot;+&quot;</span><span class="p">,</span> <span class="n">ind</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">ind</span> <span class="o">&lt;</span> <span class="n">fin</span><span class="o">-</span><span class="mi">1</span> <span class="ow">and</span> <span class="n">EstNombre</span><span class="p">(</span><span class="n">calcul</span><span class="p">[</span><span class="n">ind</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="ow">and</span> <span class="n">calcul</span><span class="p">[</span><span class="n">ind</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s">&quot;(&quot;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">debut</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span> <span class="n">debut</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">debut</span><span class="p">,</span> <span class="n">ind</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span> <span class="n">debut</span> <span class="o">=</span> <span class="n">ind</span>
            <span class="k">break</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ind</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="n">debut</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="ow">and</span> <span class="p">(</span><span class="n">debut</span><span class="o">+</span><span class="mi">2</span> <span class="o">==</span> <span class="n">fin</span> <span class="ow">or</span> <span class="p">(</span><span class="n">debut</span><span class="o">+</span><span class="mi">2</span><span class="o">&lt;</span><span class="n">fin</span> <span class="ow">and</span>
        <span class="n">calcul</span><span class="p">[</span><span class="n">debut</span><span class="o">+</span><span class="mi">2</span><span class="p">]</span> <span class="o">!=</span> <span class="s">&quot;**&quot;</span><span class="p">)):</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">debut</span><span class="p">,</span> <span class="n">debut</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span> <span class="k">return</span> <span class="bp">None</span>
</div>
<div class="viewcode-block" id="post_polynomes"><a class="viewcode-back" href="../../../pyromaths.outils.Priorites3.html#pyromaths.outils.Priorites3.post_polynomes">[docs]</a><span class="k">def</span> <span class="nf">post_polynomes</span><span class="p">(</span><span class="n">calcul</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;**post_polynomes**\ (*calcul*)</span>

<span class="sd">    Retourne la liste `calcul` dans laquelle </span>
<span class="sd">    </span>
<span class="sd">    * les polynômes sont ordonnés si nécessaire</span>
<span class="sd">    * les polynômes sont réduits s&#39;ils sont déjà ordonnés</span>

<span class="sd">    :param calcul: le calcul à traiter</span>
<span class="sd">    :type calcul: list</span>
<span class="sd">    </span>
<span class="sd">    &gt;&gt;&gt; p = [&#39;Polynome([[1, 2], [-1, 0], [3, 1], [-9, 2], [-8, 1]], &quot;x&quot;)&#39;]</span>
<span class="sd">    &gt;&gt;&gt; Priorites3.post_polynomes(p)</span>
<span class="sd">    [&#39;Polynome([[1, 2], [-9, 2], [3, 1], [-8, 1], [-1, 0]], &quot;x&quot;)&#39;]</span>
<span class="sd">    &gt;&gt;&gt; p = [&#39;Polynome([[1, 2], [-9, 2], [3, 1], [-8, 1], [-1, 0]], &quot;x&quot;)&#39;]</span>
<span class="sd">    [&#39;(&#39;, &#39;1&#39;, &#39;-&#39;, &#39;9&#39;, &#39;)&#39;, &#39;*&#39;, &#39;Polynome([[1.0, 2]], &quot;x&quot;)&#39;, &#39;+&#39;, &#39;(&#39;, &#39;3&#39;, &#39;-&#39;, &#39;8&#39;, &#39;)&#39;, &#39;*&#39;, &#39;Polynome([[1.0, 1]], &quot;x&quot;)&#39;, &#39;+&#39;, &#39;Polynome(&quot;-1x^0&quot;)&#39;]</span>
<span class="sd">    </span>
<span class="sd">    :rtype: list</span>
<span class="sd">    &quot;&quot;&quot;</span>    
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">calcul</span><span class="p">)):</span>
        <span class="k">if</span> <span class="s">&#39;Polynome(&#39;</span> <span class="ow">in</span> <span class="n">calcul</span><span class="p">[</span><span class="n">k</span><span class="p">]:</span>
            <span class="n">p</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">calcul</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">Polynome</span><span class="o">.</span><span class="n">reductible</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
                <span class="n">p</span> <span class="o">=</span> <span class="n">Polynome</span><span class="o">.</span><span class="n">reduction_detaillee</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">Polynome</span><span class="p">):</span> <span class="n">calcul</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="nb">repr</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="nb">basestring</span><span class="p">):</span> <span class="n">p</span> <span class="o">=</span> <span class="n">splitting</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">k</span> <span class="ow">and</span> <span class="n">calcul</span><span class="p">[</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="s">&quot;*-&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">k</span><span class="o">&lt;</span><span class="nb">len</span><span class="p">(</span><span class="n">calcul</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span> <span class="ow">and</span> <span class="n">calcul</span><span class="p">[</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="s">&quot;**&quot;</span><span class="p">):</span>
                        <span class="n">p</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s">&quot;(&quot;</span><span class="p">)</span>
                        <span class="n">p</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s">&quot;)&quot;</span><span class="p">)</span>
                    <span class="n">calcul</span><span class="p">[</span><span class="n">k</span><span class="p">:</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">p</span>
    <span class="k">return</span> <span class="n">calcul</span>
</div>
<div class="viewcode-block" id="effectue_calcul"><a class="viewcode-back" href="../../../pyromaths.outils.Priorites3.html#pyromaths.outils.Priorites3.effectue_calcul">[docs]</a><span class="k">def</span> <span class="nf">effectue_calcul</span><span class="p">(</span><span class="n">calcul</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;**effectue_calcul**\ (*calcul*)</span>

<span class="sd">    Effectue une étape du calcul en respectant les priorités</span>

<span class="sd">    :param calcul: le calcul à traiter</span>
<span class="sd">    :type calcul: list</span>
<span class="sd">    </span>
<span class="sd">    &gt;&gt;&gt; c = [&#39;-5&#39;, &#39;-&#39;, &#39;(&#39;, &#39;(-6)&#39;, &#39;-&#39;, &#39;1&#39;, &#39;+&#39;, &#39;(-3)&#39;, &#39;)&#39;, &#39;*&#39;, &#39;(-1)&#39;]</span>
<span class="sd">    &gt;&gt;&gt; Priorites3.effectue_calcul(c)</span>
<span class="sd">    [&#39;-5&#39;, &#39;-&#39;, &#39;(&#39;, &#39;-7&#39;, &#39;-&#39;, &#39;3&#39;, &#39;)&#39;, &#39;*&#39;, &#39;(-1)&#39;]</span>
<span class="sd">    &gt;&gt;&gt; Priorites3.effectue_calcul([&#39;-5&#39;, &#39;-&#39;, &#39;(&#39;, &#39;-7&#39;, &#39;-&#39;, &#39;3&#39;, &#39;)&#39;, &#39;*&#39;, &#39;(-1)&#39;])</span>
<span class="sd">    [&#39;-5&#39;, &#39;-&#39;, &#39;-10&#39;, &#39;*&#39;, &#39;(-1)&#39;]</span>
<span class="sd">    &gt;&gt;&gt; Priorites3.effectue_calcul([&#39;-5&#39;, &#39;-&#39;, &#39;-10&#39;, &#39;*&#39;, &#39;(-1)&#39;])</span>
<span class="sd">    [&#39;-5&#39;, &#39;-&#39;, &#39;10&#39;]</span>
<span class="sd">    &gt;&gt;&gt; Priorites3.effectue_calcul([&#39;-5&#39;, &#39;-&#39;, &#39;10&#39;])</span>
<span class="sd">    [&#39;-15&#39;]</span>
<span class="sd">    </span>
<span class="sd">    :rtype: list</span>
<span class="sd">    &quot;&quot;&quot;</span>    
    <span class="n">serie</span> <span class="o">=</span> <span class="p">(</span><span class="n">recherche_parentheses</span><span class="p">,</span> <span class="n">recherche_puissance</span><span class="p">,</span> <span class="n">recherche_produit</span><span class="p">,</span>
            <span class="n">recherche_neg</span><span class="p">,</span> <span class="n">recherche_somme</span><span class="p">)</span>
    <span class="n">result</span><span class="p">,</span> <span class="n">post</span><span class="p">,</span> <span class="n">break_somme</span> <span class="o">=</span> <span class="p">[],</span> <span class="s">&quot;&quot;</span><span class="p">,</span> <span class="bp">False</span>
    <span class="k">for</span> <span class="n">recherche</span> <span class="ow">in</span> <span class="n">serie</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">break_somme</span> <span class="ow">and</span> <span class="n">recherche</span> <span class="o">==</span> <span class="n">recherche_somme</span><span class="p">:</span> <span class="k">break</span>
        <span class="k">if</span> <span class="n">calcul</span><span class="p">:</span> <span class="n">test</span> <span class="o">=</span> <span class="n">recherche</span><span class="p">(</span><span class="n">calcul</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span> <span class="n">test</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">while</span> <span class="n">test</span><span class="p">:</span>
            <span class="n">pre</span> <span class="o">=</span> <span class="n">calcul</span><span class="p">[:</span><span class="n">test</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
            <span class="n">calc</span> <span class="o">=</span> <span class="n">calcul</span><span class="p">[</span><span class="n">test</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span><span class="n">test</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
            <span class="n">post</span> <span class="o">=</span> <span class="n">calcul</span><span class="p">[</span><span class="n">test</span><span class="p">[</span><span class="mi">1</span><span class="p">]:]</span>
            <span class="c"># On essaie d&#39;utiliser les priorités sur la première partie du</span>
            <span class="c"># calcul pour raccourcir la résolution de l&#39;expression</span>
            <span class="k">if</span> <span class="n">test</span> <span class="o">!=</span> <span class="n">recherche_neg</span> <span class="ow">and</span> <span class="n">pre</span><span class="p">:</span>
                <span class="c"># Si on simplifie les écritures, on n&#39;essaie pas les sommes</span>
                <span class="n">tmp</span> <span class="o">=</span> <span class="n">effectue_calcul</span><span class="p">(</span><span class="n">pre</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">tmp</span> <span class="ow">and</span> <span class="n">result</span> <span class="ow">and</span> <span class="n">result</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="s">&quot;+-**/(&quot;</span> <span class="ow">and</span> <span class="n">tmp</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>\
                    <span class="ow">not</span> <span class="ow">in</span> <span class="s">&quot;+-*/)&quot;</span><span class="p">:</span>
                    <span class="c"># un signe + si l&#39;expression en a besoin</span>
                    <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s">&quot;+&quot;</span><span class="p">)</span>
                <span class="c"># On ajoute le résultat ou l&#39;expression</span>
                <span class="k">if</span> <span class="n">tmp</span><span class="p">:</span> <span class="n">result</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span> <span class="n">result</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">pre</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">result</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">pre</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">recherche</span> <span class="o">==</span> <span class="n">recherche_parentheses</span><span class="p">:</span>
                <span class="c"># On supprime les parenthèses autour de l&#39;expression</span>
                <span class="n">calc</span> <span class="o">=</span> <span class="n">calc</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                <span class="c"># On réduit directement les calculs numériques dans une</span>
                <span class="c"># expression littérale</span>
                <span class="n">sol</span> <span class="o">=</span> <span class="n">effectue_calcul</span><span class="p">(</span><span class="n">calc</span><span class="p">)</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sol</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">:</span>
                    <span class="n">sol</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s">&quot;(&quot;</span><span class="p">)</span>
                    <span class="n">sol</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s">&quot;)&quot;</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">sol</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="nb">eval</span><span class="p">(</span><span class="n">sol</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">))</span> <span class="ow">and</span> <span class="n">post</span> <span class="ow">and</span> <span class="n">post</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s">&quot;*&quot;</span> <span class="ow">and</span> \
                        <span class="s">&#39;Polynome(&#39;</span> <span class="ow">in</span> <span class="n">post</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="nb">eval</span><span class="p">(</span><span class="n">post</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> \
                        <span class="nb">eval</span><span class="p">(</span><span class="n">post</span><span class="p">[</span><span class="mi">1</span><span class="p">])[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                            <span class="c"># Sans doute une factorisation de sommes de polynômes</span>
                            <span class="n">sol</span> <span class="o">=</span> <span class="p">[</span><span class="nb">repr</span><span class="p">(</span><span class="nb">eval</span><span class="p">(</span><span class="n">sol</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">*</span><span class="nb">eval</span><span class="p">(</span><span class="n">post</span> <span class="p">[</span><span class="mi">1</span><span class="p">]))]</span>
                            <span class="n">post</span> <span class="o">=</span> <span class="n">post</span><span class="p">[</span><span class="mi">2</span><span class="p">:]</span>
                            <span class="c">#Suppression des parenthèses autour de ((9.0-80.0)*Polynome(&quot;x&quot;)) devenu (Polynome(&quot;-71.0x&quot;))</span>
                            <span class="k">if</span> <span class="n">post</span> <span class="ow">and</span> <span class="n">result</span> <span class="ow">and</span> <span class="n">post</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s">&quot;)&quot;</span> <span class="ow">and</span> <span class="n">result</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s">&quot;(&quot;</span> <span class="p">:</span>
                                <span class="n">result</span><span class="p">,</span>  <span class="n">post</span> <span class="o">=</span> <span class="n">result</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>  <span class="n">post</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c"># Transforme les réels en polynômes afin de permettre les opérations</span>
                <span class="n">bpoly</span> <span class="o">=</span> <span class="bp">False</span>
                <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">calc</span><span class="p">)):</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="n">bpoly</span> <span class="ow">and</span> <span class="n">calc</span><span class="p">[</span><span class="n">k</span><span class="p">][:</span><span class="mi">9</span><span class="p">]</span> <span class="o">==</span> <span class="s">&quot;Polynome(&quot;</span><span class="p">:</span> <span class="n">bpoly</span> <span class="o">=</span> <span class="bp">True</span>
                    <span class="k">elif</span> <span class="n">bpoly</span> <span class="ow">and</span> <span class="n">calc</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="s">&quot;**/-+()&quot;</span> <span class="ow">and</span> <span class="n">calc</span><span class="p">[</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="s">&quot;**&quot;</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="nb">eval</span><span class="p">(</span><span class="n">calc</span><span class="p">[</span><span class="n">k</span><span class="p">]),</span> <span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">)):</span>
                        <span class="n">calc</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;Polynome([[</span><span class="si">%s</span><span class="s">, 0]])&quot;</span> <span class="o">%</span> <span class="nb">eval</span><span class="p">(</span><span class="n">calc</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                <span class="n">sol</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="s">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">calc</span><span class="p">))</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sol</span><span class="p">,</span> <span class="nb">basestring</span><span class="p">):</span> <span class="n">sol</span> <span class="o">=</span> <span class="n">splitting</span><span class="p">(</span><span class="n">sol</span><span class="p">)</span>
                <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sol</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">)):</span> <span class="n">sol</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">sol</span><span class="p">)]</span>
                <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sol</span><span class="p">,</span> <span class="n">Polynome</span><span class="p">):</span> <span class="n">sol</span> <span class="o">=</span> <span class="p">[</span><span class="nb">repr</span><span class="p">(</span><span class="n">sol</span><span class="p">)]</span>
                <span class="k">else</span> <span class="p">:</span> <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">u&quot;Le résultat a un format inattendu&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">recherche</span> <span class="o">==</span> <span class="n">recherche_neg</span><span class="p">:</span>
                <span class="c"># Ajoute le &quot;+&quot; ou sépare le &quot;-&quot;:</span>
                <span class="c"># &quot;1-(-9)&quot; =&gt; &quot;1 + 9&quot; et &quot;1+(-9)&quot; =&gt; &quot;1 - 9&quot;</span>
                <span class="k">if</span> <span class="n">sol</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s">&quot;-&quot;</span><span class="p">:</span> <span class="n">sol</span> <span class="o">=</span> <span class="p">[</span><span class="s">&quot;-&quot;</span><span class="p">,</span> <span class="n">sol</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">:]]</span>
                <span class="k">else</span><span class="p">:</span> <span class="n">sol</span> <span class="o">=</span> <span class="p">[</span><span class="s">&quot;+&quot;</span><span class="p">,</span> <span class="n">sol</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
            <span class="k">if</span> <span class="n">recherche</span> <span class="o">==</span> <span class="n">recherche_produit</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">sol</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="c"># Ajoute les parenthèses si produit précédé d&#39;un &quot;-&quot; ou &quot;*&quot;</span>
                <span class="c"># ou suivi d&#39;un &quot;*&quot;</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">result</span> <span class="ow">and</span> <span class="n">result</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="s">&quot;*-&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">post</span> <span class="ow">and</span> <span class="n">post</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s">&quot;*&quot;</span><span class="p">):</span>
                    <span class="n">sol</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s">&quot;(&quot;</span><span class="p">)</span>
                    <span class="n">sol</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s">&quot;)&quot;</span><span class="p">)</span>
            <span class="c"># Si @sol est négatif et @result se termine par un &quot;+&quot;, on l&#39;enlève</span>
            <span class="k">if</span> <span class="n">result</span> <span class="ow">and</span> <span class="n">result</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s">&quot;+&quot;</span> <span class="ow">and</span> <span class="n">sol</span> <span class="ow">and</span> <span class="n">sol</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s">&quot;-&quot;</span><span class="p">:</span>
                    <span class="n">result</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;-&quot;</span>
                    <span class="n">sol</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">sol</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">lstrip</span><span class="p">(</span><span class="s">&quot;-&quot;</span><span class="p">)</span>
            <span class="n">result</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">sol</span><span class="p">)</span>
            <span class="n">calcul</span> <span class="o">=</span> <span class="n">post</span>
            <span class="k">if</span> <span class="n">calcul</span><span class="p">:</span> <span class="n">test</span> <span class="o">=</span> <span class="n">recherche</span><span class="p">(</span><span class="n">calcul</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span> <span class="n">test</span> <span class="o">=</span> <span class="bp">None</span>
            <span class="k">if</span> <span class="n">post</span> <span class="ow">and</span> <span class="n">recherche</span> <span class="o">==</span> <span class="n">recherche_neg</span><span class="p">:</span> <span class="n">break_somme</span><span class="o">=</span><span class="bp">True</span>
    <span class="n">result</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">post</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">result</span><span class="p">:</span> <span class="n">result</span> <span class="o">=</span> <span class="n">calcul</span>
    <span class="n">tmp</span> <span class="o">=</span> <span class="s">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="c">#    if cherche_polynome(tmp, 0):</span>
<span class="c">#        index = tmp.find(&quot;+-&quot;)</span>
<span class="c">#        while index &gt;=0 :</span>
<span class="c">#            nb = cherche_decimal(tmp, index+2)</span>
<span class="c">#            tmp = tmp[:index+1] + &quot;(-&quot; + nb + &quot;)&quot; + tmp[index+2+len(nb):]</span>
<span class="c">#            index = tmp.find(&quot;+-&quot;)</span>
<span class="c">#        result = splitting(tmp)</span>
    <span class="k">return</span> <span class="n">result</span>
</div>
<div class="viewcode-block" id="priorites"><a class="viewcode-back" href="../../../pyromaths.outils.Priorites3.html#pyromaths.outils.Priorites3.priorites">[docs]</a><span class="k">def</span> <span class="nf">priorites</span><span class="p">(</span><span class="n">calcul</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;**priorites**\ (*calcul*)</span>

<span class="sd">    Effectue un enchaînement d&#39;opérations contenues dans calcul en</span>
<span class="sd">    respectant les priorités et en détaillant les étapes.</span>

<span class="sd">    :param calcul: le calcul à traiter</span>
<span class="sd">    :type calcul: string</span>
<span class="sd">    </span>
<span class="sd">    &gt;&gt;&gt; c = &#39;-1+5-(-5)+(-6)*1&#39;</span>
<span class="sd">    &gt;&gt;&gt; Priorites3.priorites(c)</span>
<span class="sd">    [[&#39;4&#39;, &#39;+&#39;, &#39;5&#39;, &#39;-&#39;, &#39;6&#39;], [&#39;9&#39;, &#39;-&#39;, &#39;6&#39;], [&#39;3&#39;]]</span>
<span class="sd">    </span>
<span class="sd">    :rtype: list</span>
<span class="sd">    &quot;&quot;&quot;</span>
<span class="c">#    if cherche_polynome(calcul, 0)&gt;=0: litteral = True</span>
<span class="c">#    else: litteral = False</span>
    <span class="n">calcul</span> <span class="o">=</span> <span class="n">splitting</span><span class="p">(</span><span class="n">calcul</span><span class="p">)</span>
    <span class="n">solution</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">calcul</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">:</span>
        <span class="n">s</span><span class="o">=</span> <span class="n">effectue_calcul</span><span class="p">(</span><span class="n">calcul</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">s</span><span class="p">:</span>
            <span class="n">s</span> <span class="o">=</span> <span class="n">post_polynomes</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
            <span class="n">solution</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
        <span class="n">calcul</span> <span class="o">=</span> <span class="p">[</span><span class="n">k</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">s</span><span class="p">]</span> <span class="c"># dissocie calcul et s</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">calcul</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">post_polynomes</span><span class="p">(</span><span class="n">calcul</span><span class="p">)</span> <span class="o">!=</span> <span class="n">s</span><span class="p">:</span>
            <span class="c"># Finit la réduction du polynôme résultat</span>
            <span class="n">solution</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">calcul</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">solution</span>
</div>
<div class="viewcode-block" id="texify"><a class="viewcode-back" href="../../../pyromaths.outils.Priorites3.html#pyromaths.outils.Priorites3.texify">[docs]</a><span class="k">def</span> <span class="nf">texify</span><span class="p">(</span><span class="n">liste_calculs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;**texify**\ (*liste_calculs*)</span>

<span class="sd">    Convertit la liste de chaînes de caractères `liste_calculs` contenant</span>
<span class="sd">    des polynômes en liste de chaînes de caractères au format TeX</span>

<span class="sd">    **TODO :** intégrer cela dans :mod:`outils.Affichage` et gérer l&#39;ensemble des</span>
<span class="sd">    classes de Pyromaths.</span>
<span class="sd">    </span>
<span class="sd">    :param calcul: le calcul à traiter</span>
<span class="sd">    :type calcul: string</span>
<span class="sd">    </span>
<span class="sd">    &gt;&gt;&gt; l = [[&#39;4&#39;, &#39;+&#39;, &#39;5&#39;, &#39;-&#39;, &#39;6&#39;], [&#39;9&#39;, &#39;-&#39;, &#39;6&#39;], [&#39;3&#39;]]</span>
<span class="sd">    &gt;&gt;&gt; Priorites3.texify(l)</span>
<span class="sd">    [&#39;4+5-6&#39;, &#39;9-6&#39;, &#39;3&#39;]</span>
<span class="sd">    &gt;&gt;&gt; p = &#39;(-7)+8-Polynome([[-4, 1], [-9, 2], [-5, 0]], &quot;x&quot;)&#39;</span>
<span class="sd">    &gt;&gt;&gt; Priorites3.texify(Priorites3.priorites(p))</span>
<span class="sd">    [&#39;1+4\\,x+9\\,x^{2}+5&#39;, &#39;9\\,x^{2}+4\\,x+1+5&#39;, &#39;9\\,x^{2}+4\\,x+6&#39;]</span>
<span class="sd">    </span>
<span class="sd">    :rtype: list</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ls</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">calcul</span> <span class="ow">in</span> <span class="n">liste_calculs</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">calcul</span><span class="p">,</span>  <span class="nb">basestring</span><span class="p">):</span> <span class="n">calcul</span> <span class="o">=</span> <span class="n">splitting</span><span class="p">(</span><span class="n">calcul</span><span class="p">)</span>
        <span class="n">s</span> <span class="o">=</span> <span class="s">&quot;&quot;</span>
        <span class="n">puiss</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">calcul</span><span class="p">)):</span>
            <span class="n">el</span> <span class="o">=</span> <span class="n">calcul</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">el</span><span class="p">[:</span><span class="mi">9</span><span class="p">]</span> <span class="o">==</span> <span class="s">&quot;Polynome(&quot;</span><span class="p">:</span>
                <span class="c"># Doit-on entourer ce polynôme de parenthèses ?</span>
                <span class="n">p</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">el</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">calcul</span><span class="p">):</span> <span class="n">q</span> <span class="o">=</span> <span class="n">calcul</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span> <span class="n">q</span><span class="o">=</span> <span class="s">&quot;&quot;</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">s</span> <span class="ow">and</span> <span class="n">s</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="s">&quot;*-&quot;</span> <span class="ow">and</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">p</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">1</span> <span class="ow">or</span> <span class="n">p</span><span class="o">.</span><span class="n">monomes</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">))</span> \
                    <span class="ow">or</span> <span class="p">(</span><span class="n">q</span> <span class="ow">and</span> <span class="n">q</span> <span class="o">==</span> <span class="s">&quot;*&quot;</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">p</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">)</span> \
                    <span class="ow">or</span> <span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">p</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">1</span> <span class="ow">or</span> <span class="n">p</span><span class="o">.</span><span class="n">monomes</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">!=</span><span class="mi">1</span><span class="p">)</span> <span class="ow">and</span> <span class="n">q</span> <span class="ow">and</span> <span class="n">q</span> <span class="o">==</span> <span class="s">&quot;**&quot;</span><span class="p">):</span>
                    <span class="n">s</span> <span class="o">+=</span> <span class="s">&quot;(&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="o">+</span><span class="s">&quot;)&quot;</span>
                <span class="k">elif</span> <span class="n">s</span> <span class="ow">and</span> <span class="n">s</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s">&quot;+&quot;</span> <span class="ow">and</span> <span class="n">p</span><span class="o">.</span><span class="n">monomes</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">:</span>
                    <span class="n">s</span> <span class="o">=</span> <span class="n">s</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                    <span class="n">s</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">s</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">EstNombre</span><span class="p">(</span><span class="n">el</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">el</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="s">&quot;(&quot;</span><span class="p">:</span> <span class="n">s</span> <span class="o">+=</span> <span class="s">&quot;(&quot;</span> <span class="o">+</span> <span class="n">decimaux</span><span class="p">(</span><span class="n">el</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="s">&quot;)&quot;</span>
                <span class="k">else</span><span class="p">:</span> <span class="n">s</span> <span class="o">+=</span> <span class="n">decimaux</span><span class="p">(</span><span class="n">el</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">el</span> <span class="o">==</span> <span class="s">&quot;**&quot;</span><span class="p">:</span>
                <span class="n">s</span> <span class="o">+=</span> <span class="s">&quot;**{&quot;</span>
                <span class="n">puiss</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">elif</span> <span class="n">el</span> <span class="o">==</span> <span class="s">&quot;(&quot;</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">puiss</span><span class="p">:</span> <span class="n">puiss</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="n">s</span> <span class="o">+=</span> <span class="s">&quot;(&quot;</span>
            <span class="k">elif</span> <span class="n">el</span> <span class="o">==</span> <span class="s">&quot;)&quot;</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">puiss</span><span class="p">:</span> <span class="n">puiss</span> <span class="o">-=</span> <span class="mi">1</span>
                <span class="n">s</span> <span class="o">+=</span> <span class="s">&quot;)&quot;</span>
            <span class="k">else</span> <span class="p">:</span>
                <span class="c"># &quot;+&quot;, &quot;-&quot;, &quot;*&quot;, &quot;/&quot;</span>
                <span class="n">s</span> <span class="o">+=</span> <span class="n">el</span>
            <span class="k">if</span> <span class="n">puiss</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">s</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="s">&quot;{&quot;</span><span class="p">:</span>
                <span class="n">puiss</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="n">s</span> <span class="o">+=</span> <span class="s">&quot;}&quot;</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&quot;**{&quot;</span><span class="p">,</span> <span class="s">&quot;^{&quot;</span><span class="p">)</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&quot;(&quot;</span><span class="p">,</span> <span class="s">&quot;</span><span class="se">\\</span><span class="s">left( &quot;</span><span class="p">)</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&quot;)&quot;</span><span class="p">,</span> <span class="s">&quot;</span><span class="se">\\</span><span class="s">right) &quot;</span><span class="p">)</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&quot;*&quot;</span><span class="p">,</span> <span class="s">&quot;</span><span class="se">\\</span><span class="s">times &quot;</span><span class="p">)</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&quot;/&quot;</span><span class="p">,</span> <span class="s">&quot;</span><span class="se">\\</span><span class="s">div &quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">ls</span> <span class="ow">or</span> <span class="n">s</span> <span class="o">!=</span> <span class="n">ls</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
            <span class="n">ls</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ls</span>

<span class="c">#----------------------------------------------------------------------</span>
<span class="c"># Pyromaths : FICHIERS DE TESTS</span>
<span class="c">#----------------------------------------------------------------------</span></div>
<div class="viewcode-block" id="valeurs"><a class="viewcode-back" href="../../../pyromaths.outils.Priorites3.html#pyromaths.outils.Priorites3.valeurs">[docs]</a><span class="k">def</span> <span class="nf">valeurs</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">polynomes</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">entier</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;*fichier de tests :* Renvoie une chaîne de caractères contenant un calcul aléatoire de</span>
<span class="sd">    n nombres, qui sont soit des entiers, soit des décimaux, soit des polynômes.&quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">random</span>
    <span class="k">def</span> <span class="nf">deci</span><span class="p">(</span><span class="n">entier</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">entier</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">random</span><span class="o">.</span><span class="n">randrange</span><span class="p">(</span><span class="o">-</span><span class="mi">11</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">random</span><span class="o">.</span><span class="n">randrange</span><span class="p">(</span><span class="o">-</span><span class="mi">110</span><span class="p">,</span> <span class="mi">110</span><span class="p">)</span><span class="o">/</span><span class="mf">10.</span>
    <span class="k">def</span> <span class="nf">poly</span><span class="p">(</span><span class="n">entier</span><span class="p">):</span>
        <span class="n">lg</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randrange</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
        <span class="n">degre</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
        <span class="n">p</span> <span class="o">=</span> <span class="p">[[</span><span class="n">deci</span><span class="p">(</span><span class="n">entier</span><span class="p">),</span> <span class="n">degre</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">randrange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">degre</span><span class="p">)))]</span> <span class="k">for</span> <span class="n">dummy</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">lg</span><span class="o">+</span><span class="mi">1</span><span class="p">)]</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">Polynome</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="s">&quot;x&quot;</span><span class="p">)</span>
        <span class="k">while</span> <span class="n">p</span> <span class="o">==</span> <span class="n">Polynome</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]],</span> <span class="s">&quot;x&quot;</span><span class="p">):</span>
            <span class="n">degre</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
            <span class="n">p</span> <span class="o">=</span> <span class="p">[[</span><span class="n">deci</span><span class="p">(</span><span class="n">entier</span><span class="p">),</span> <span class="n">degre</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">randrange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">degre</span><span class="p">)))]</span> <span class="k">for</span> <span class="n">dummy</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">lg</span><span class="o">+</span><span class="mi">1</span><span class="p">)]</span>
            <span class="n">p</span> <span class="o">=</span> <span class="n">Polynome</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="s">&quot;x&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">Polynome</span><span class="o">.</span><span class="n">degre</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">p</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">p</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span> <span class="n">p</span> <span class="o">=</span> <span class="s">&quot;(&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="o">+</span><span class="s">&quot;)&quot;</span>
            <span class="k">else</span><span class="p">:</span> <span class="n">p</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span> <span class="n">p</span> <span class="o">=</span> <span class="nb">repr</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">p</span>
    <span class="k">if</span> <span class="n">polynomes</span><span class="p">:</span> <span class="n">nb</span><span class="o">=</span><span class="n">poly</span>
    <span class="k">else</span><span class="p">:</span> <span class="n">nb</span><span class="o">=</span><span class="n">deci</span>
    <span class="n">nbp</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">lo</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;+&#39;</span><span class="p">,</span><span class="s">&#39;*&#39;</span><span class="p">,</span><span class="s">&#39;-&#39;</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">i</span><span class="p">:</span>
            <span class="n">s</span> <span class="o">=</span> <span class="s">&quot;</span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">nb</span><span class="p">(</span><span class="n">entier</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">nbp</span> <span class="ow">and</span> <span class="n">nbp</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">2</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">random</span><span class="o">.</span><span class="n">randrange</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
                <span class="n">s</span> <span class="o">+=</span> <span class="s">&#39;)&#39;</span>
                <span class="n">nbp</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">s</span> <span class="o">+=</span> <span class="n">lo</span><span class="p">[</span><span class="n">random</span><span class="o">.</span><span class="n">randrange</span><span class="p">(</span><span class="mi">3</span><span class="p">)]</span>
            <span class="k">if</span> <span class="n">nbp</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">cpt</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">nbp</span><span class="p">)):</span>
                    <span class="n">nbp</span><span class="p">[</span><span class="n">cpt</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">a</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randrange</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">s</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="s">&#39;*-/&#39;</span> <span class="ow">and</span> <span class="n">i</span><span class="o">&lt;=</span><span class="n">n</span><span class="o">-</span><span class="mi">2</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">a</span><span class="p">:</span>
                <span class="n">s</span> <span class="o">+=</span> <span class="s">&#39;(&#39;</span>
                <span class="n">nbp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">nombre</span> <span class="o">=</span> <span class="n">nb</span><span class="p">(</span><span class="n">entier</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">nombre</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span> <span class="n">s</span> <span class="o">+=</span> <span class="s">&quot;(&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">nombre</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;)&quot;</span>
            <span class="k">else</span><span class="p">:</span> <span class="n">s</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="n">nombre</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">polynomes</span><span class="p">:</span> <span class="c">#TODO: tester les puissances avec les polynômes</span>
                <span class="n">a</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randrange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
                <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">nbp</span> <span class="ow">or</span> <span class="n">nbp</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">a</span><span class="p">:</span>
                    <span class="n">s</span> <span class="o">+=</span> <span class="s">&quot;**2&quot;</span>
    <span class="k">while</span> <span class="n">nbp</span><span class="p">:</span>
        <span class="n">s</span> <span class="o">+=</span> <span class="s">&#39;)&#39;</span>
        <span class="n">nbp</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">s</span>
</div>
<span class="k">def</span> <span class="nf">test_entiers</span><span class="p">(</span><span class="n">nbval</span><span class="p">,</span> <span class="n">polynomes</span><span class="p">,</span> <span class="n">entiers</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10000</span><span class="p">):</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">valeurs</span><span class="p">(</span><span class="n">nbval</span><span class="p">,</span> <span class="n">polynomes</span><span class="p">,</span> <span class="n">entiers</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">r</span> <span class="o">=</span> <span class="n">priorites</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
            <span class="n">texify</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
            <span class="k">break</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">polynomes</span><span class="p">:</span>
                <span class="k">print</span> <span class="s">u&quot;</span><span class="si">%s</span><span class="s"> ème calcul&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">c</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="n">a</span><span class="p">,</span> <span class="s">&quot; = &quot;</span><span class="p">,</span> <span class="nb">eval</span><span class="p">(</span><span class="n">a</span><span class="p">),</span> <span class="s">u&quot; en </span><span class="si">%s</span><span class="s"> étapes&quot;</span><span class="o">%</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">r</span><span class="p">))</span>
                <span class="k">if</span> <span class="nb">eval</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">eval</span><span class="p">(</span><span class="s">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])):</span>
                    <span class="k">print</span> <span class="n">a</span><span class="p">,</span> <span class="s">&quot; = &quot;</span><span class="p">,</span> <span class="nb">eval</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
                    <span class="k">print</span> <span class="n">r</span>
                    <span class="k">break</span>
            <span class="k">if</span> <span class="n">polynomes</span><span class="p">:</span>
                <span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">Symbol</span><span class="p">,</span> <span class="n">expand</span>
                <span class="n">x</span> <span class="o">=</span> <span class="n">Symbol</span><span class="p">(</span><span class="s">&#39;x&#39;</span><span class="p">)</span>
                <span class="k">print</span> <span class="s">u&quot; : </span><span class="si">%s</span><span class="s"> ème calcul en </span><span class="si">%s</span><span class="s"> étapes&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">c</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">r</span><span class="p">))</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">r</span><span class="p">):</span>
                    <span class="k">print</span> <span class="n">a</span>
                    <span class="k">break</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">t0</span><span class="o">=</span><span class="n">sympyfy</span><span class="p">([</span><span class="n">a</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="n">t1</span><span class="o">=</span><span class="n">sympyfy</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="nb">eval</span><span class="p">(</span><span class="n">t1</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">))</span> <span class="p">:</span> <span class="n">t1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;</span><span class="si">%s</span><span class="s">+x-x&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">t1</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="nb">eval</span><span class="p">(</span><span class="n">t0</span><span class="p">),</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">))</span> <span class="p">:</span> <span class="n">t0</span> <span class="o">=</span> <span class="s">&quot;</span><span class="si">%s</span><span class="s">+x-x&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">t0</span><span class="p">)</span>

                    <span class="k">if</span> <span class="nb">eval</span><span class="p">(</span><span class="n">t0</span><span class="p">)</span><span class="o">.</span><span class="n">expand</span><span class="p">()</span><span class="o">!=</span><span class="nb">eval</span><span class="p">(</span><span class="n">t1</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">expand</span><span class="p">():</span>
                        <span class="k">print</span> <span class="n">a</span><span class="p">,</span> <span class="s">&quot;=&quot;</span><span class="p">,</span> <span class="n">t1</span>
                        <span class="k">print</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">sympyfy</span><span class="p">(</span><span class="n">r</span><span class="p">))</span>

                        <span class="k">print</span> <span class="s">u&quot;Devrait être : &quot;</span><span class="p">,</span> <span class="nb">eval</span><span class="p">(</span><span class="n">t0</span><span class="p">)</span><span class="o">.</span><span class="n">expand</span><span class="p">()</span>
                        <span class="k">break</span>

<div class="viewcode-block" id="sympyfy"><a class="viewcode-back" href="../../../pyromaths.outils.Priorites3.html#pyromaths.outils.Priorites3.sympyfy">[docs]</a><span class="k">def</span> <span class="nf">sympyfy</span><span class="p">(</span><span class="n">liste_calculs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;*fichier de tests :* Convertit une liste de chaînes de caractères &#39;liste_calculs&#39; contenant</span>
<span class="sd">    des polynômes en liste de chaînes de caractères au format Sympy&quot;&quot;&quot;</span>
    <span class="n">ls</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">calcul</span> <span class="ow">in</span> <span class="n">liste_calculs</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">calcul</span><span class="p">,</span>  <span class="nb">basestring</span><span class="p">):</span> <span class="n">calcul</span> <span class="o">=</span> <span class="n">splitting</span><span class="p">(</span><span class="n">calcul</span><span class="p">)</span>
        <span class="n">s</span> <span class="o">=</span> <span class="s">&quot;&quot;</span>
        <span class="n">puiss</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">calcul</span><span class="p">)):</span>
            <span class="n">el</span> <span class="o">=</span> <span class="n">calcul</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">el</span><span class="p">[:</span><span class="mi">9</span><span class="p">]</span> <span class="o">==</span> <span class="s">&quot;Polynome(&quot;</span><span class="p">:</span>
                <span class="c"># Doit-on entourer ce polynôme de parenthèses ?</span>
                <span class="n">p</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">el</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">calcul</span><span class="p">):</span> <span class="n">q</span> <span class="o">=</span> <span class="n">calcul</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span> <span class="n">q</span><span class="o">=</span> <span class="s">&quot;&quot;</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">s</span> <span class="ow">and</span> <span class="n">s</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="s">&quot;*-&quot;</span> <span class="ow">and</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">p</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">1</span> <span class="ow">or</span> <span class="n">p</span><span class="o">.</span><span class="n">monomes</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">))</span> \
                    <span class="ow">or</span> <span class="p">(</span><span class="n">q</span> <span class="ow">and</span> <span class="n">q</span> <span class="o">==</span> <span class="s">&quot;*&quot;</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">p</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">)</span> \
                    <span class="ow">or</span> <span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">p</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">1</span> <span class="ow">or</span> <span class="n">p</span><span class="o">.</span><span class="n">monomes</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">!=</span><span class="mi">1</span><span class="p">)</span> <span class="ow">and</span> <span class="n">q</span> <span class="ow">and</span> <span class="n">q</span> <span class="o">==</span> <span class="s">&quot;**&quot;</span><span class="p">):</span>
                    <span class="n">s</span> <span class="o">+=</span> <span class="s">&quot;(&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="o">+</span><span class="s">&quot;)&quot;</span>
                <span class="k">elif</span> <span class="n">s</span> <span class="ow">and</span> <span class="n">s</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s">&quot;+&quot;</span> <span class="ow">and</span> <span class="n">p</span><span class="o">.</span><span class="n">monomes</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">:</span>
                    <span class="n">s</span> <span class="o">=</span> <span class="n">s</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                    <span class="n">s</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">s</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">EstNombre</span><span class="p">(</span><span class="n">el</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">el</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="s">&quot;(&quot;</span><span class="p">:</span> <span class="n">s</span> <span class="o">+=</span> <span class="s">&quot;(&quot;</span> <span class="o">+</span> <span class="n">decimaux</span><span class="p">(</span><span class="n">el</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="s">&quot;)&quot;</span>
                <span class="k">else</span><span class="p">:</span> <span class="n">s</span> <span class="o">+=</span> <span class="n">decimaux</span><span class="p">(</span><span class="n">el</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">el</span> <span class="o">==</span> <span class="s">&quot;**&quot;</span><span class="p">:</span>
                <span class="n">s</span> <span class="o">+=</span> <span class="s">&quot;**{&quot;</span>
                <span class="n">puiss</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">elif</span> <span class="n">el</span> <span class="o">==</span> <span class="s">&quot;(&quot;</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">puiss</span><span class="p">:</span> <span class="n">puiss</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="n">s</span> <span class="o">+=</span> <span class="s">&quot;(&quot;</span>
            <span class="k">elif</span> <span class="n">el</span> <span class="o">==</span> <span class="s">&quot;)&quot;</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">puiss</span><span class="p">:</span> <span class="n">puiss</span> <span class="o">-=</span> <span class="mi">1</span>
                <span class="n">s</span> <span class="o">+=</span> <span class="s">&quot;)&quot;</span>
            <span class="k">else</span> <span class="p">:</span>
                <span class="c"># &quot;+&quot;, &quot;-&quot;, &quot;*&quot;, &quot;/&quot;</span>
                <span class="n">s</span> <span class="o">+=</span> <span class="n">el</span>
            <span class="k">if</span> <span class="n">puiss</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">puiss</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="n">s</span> <span class="o">+=</span> <span class="s">&quot;}&quot;</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\\</span><span class="s">,x&quot;</span><span class="p">,</span> <span class="s">&quot;*x&quot;</span><span class="p">)</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\\</span><span class="s">,&quot;</span><span class="p">,</span> <span class="s">&quot;&quot;</span><span class="p">)</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&quot;**{&quot;</span><span class="p">,</span> <span class="s">&quot;**&quot;</span><span class="p">)</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&quot;^{&quot;</span><span class="p">,</span> <span class="s">&quot;**&quot;</span><span class="p">)</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&quot;}&quot;</span><span class="p">,</span> <span class="s">&quot;&quot;</span><span class="p">)</span>
<span class="c">#        s = s.replace(&quot;(&quot;, &quot;\\left( &quot;)</span>
<span class="c">#        s = s.replace(&quot;)&quot;, &quot;\\right) &quot;)</span>
<span class="c">#        s = s.replace(&quot;**{&quot;, &quot;^{&quot;)</span>
<span class="c">#        s = s.replace(&quot;*&quot;, &quot;\\times &quot;)</span>
<span class="c">#        s = s.replace(&quot;/&quot;, &quot;\\div &quot;)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">ls</span> <span class="ow">or</span> <span class="n">s</span> <span class="o">!=</span> <span class="n">ls</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
            <span class="n">ls</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ls</span>
</div>
<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">Symbol</span><span class="p">,</span> <span class="n">expand</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">Symbol</span><span class="p">(</span><span class="s">&#39;x&#39;</span><span class="p">)</span>
    <span class="n">test_entiers</span><span class="p">(</span><span class="n">nbval</span><span class="o">=</span><span class="mi">13</span><span class="p">,</span> <span class="n">polynomes</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">entiers</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="c">#    a = valeurs(2, 1, 1)</span>
<span class="c">#    a = &#39;Polynome([[8, 2]], &quot;x&quot;)*Polynome([[3, 1]], &quot;x&quot;)-Polynome([[-3, 0], [4, 2], [10, 1]], &quot;x&quot;)*Polynome([[-4, 2], [5, 0], [-11, 1]], &quot;x&quot;)-Polynome([[3, 2], [-5, 1]], &quot;x&quot;)-(Polynome([[3, 2], [-1, 0]], &quot;x&quot;)*Polynome([[3, 2], [1, 0]], &quot;x&quot;)*Polynome([[-6, 2], [10, 1], [2, 0]], &quot;x&quot;))*Polynome([[-9, 0], [-7, 2], [8, 1]], &quot;x&quot;)-Polynome([[-8, 1]], &quot;x&quot;)+Polynome([[-8, 2], [4, 0]], &quot;x&quot;)+Polynome([[10, 1]], &quot;x&quot;)+Polynome([[-9, 2], [6, 1], [7, 0]], &quot;x&quot;)&#39;</span>
<span class="c">#    print(a)</span>
<span class="c">##    s= sympyfy([a])</span>
<span class="c">#    print sympyfy(priorites(a))</span>
<span class="c">#    r = texify(priorites(a))</span>
<span class="c">#    print &quot;\\item $A=&quot;, texify([a])[0] , &quot;$\\par&quot;</span>
<span class="c">#    for i in r:</span>
<span class="c">#        print &quot;$A=&quot;,</span>
<span class="c">#        print &quot;&quot;.join(i),</span>
<span class="c">#        print &quot;$\\par&quot;</span>
</pre></div>

      </div>
      <div class="bottomnav">
      
        <p>
        <a class="uplink" href="../../../index.html">Contenu</a>
        </p>

      </div>

    <div class="footer">
        &copy; Copyright 2013, Jérôme Ortais.
      Créé avec <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>